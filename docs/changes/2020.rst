.. include:: /../docs/shared/include/defs.rst
.. _lino.changes.2020:
.. _xl.changes.2020:
.. _book.changes.2020:

====
2020
====

This is the 2020 :term:`change log` for :ref:`book`.
General information about how to read and maintain this document in :ref:`dev.changes`.

.. contents::
  :local:

2020-05-13
==========

Fixed :ticket:`3637` (can only concatenate str (not "__proxy__") to str).

2020-05-04
==========

Released Lino 20.5.1 and XL 20.4.2. With several internal optimizations that
caused the test suites of book, presto, amici and welfare to fail.


2020-04-21
==========

Lino no longer allows several transitions for a same target state. Every state
of a workflow can have at most one "transition" action for entering this state.
This change imposes more discipline for application developers when designing a
workflow definition. It has the advantage that you can now access the transition
of a given state in order to change its configuration.  For example
:ref:`presto` uses this to change the
:class:`lino_xl.lib.cal.MarkEventTookPlace` transition. Added a new attribute
:class:`lino.core.workflows.State.transition` and a new exception "Tried to add
another transition to <state name>".  The :mod:`lino_book.projects.workflows`
demo project is an example of an application that had to be adapted to this new
limitation.


2020-04-18
==========

Added a new observable date range :class:`lino.mixins.periods.Weekly`.

Released Lino 20.4.1 and XL 20.4.2.

2020-03-15
==========

Released to PyPI : lino lino-xl

Fix ImportError: cannot import name 'ZERO_DURATION' from 'lino.utils.quantities'

2020-03-10
==========

The :attr:`has_open_movements
<lino_xl.lib.contacts.PartnerEvents.has_open_movements>`  choice to the
:attr:`observed_events <lino_xl.lib.contacts.Partners.observed_events>`
parameter field of the :class:`lino_xl.lib.contacts.Partners` table didn't work
and was not tested. Fixed it and added test coverage in :ref:`xl.specs.ledger`.

2020-03-07
==========

New method :meth:`lino.core.tablerequest.TableRequest.gen_insert_button` is a
generalized and no longer hackerish implementation of the hackerish solution
used in the calview monthly view until now.

When the label of a table is None, the ExtJS front-end now
suppresses the header of the grid panel (including the "open in own window"
button).  This is used by the slave tables in the detail layouts of the
calendar views. But note that you cannot simply set ``label = None`` on the
actor because that default value is overridden by the model's
:attr:`verbose_name_plural`. So to get an actor without label you be more
explicit and say::

    @classmethod
    def get_actor_label(cls):
        return None


2020-02-04
==========

Released to PyPI : react

2020-01-28
==========

New feature: every voucher model can now define its own workflow rules. This
change required the workflow state field of vouchers to move from the Voucher
model to the implementing MTI child models. This requires manual changes in the
:xfile:`restore.py` file when migrating existing data.

2020-01-27
==========

Released to PyPI : lino 20.1.1 and xl 20.1.4 (because amici, presto etc are
failing on travis).

2020-01-24
==========

:func:`show_complexity_factors` no longer counts actions with
:attr:`no_params_window`.


2020-01-22
==========

Fixed a bug that caused :attr:`lino.core.choicelists.ChoiceList.preferred_width`
to be 4 for all choicelists. Wrote a new doctest utility
:func:`lino.api.doctest.show_choicelists` so that application maintainers can
easily cover these in their specs.  Usage example is :ref:`specs.cosi.apc`.

2020-01-18
==========

Released to PyPI : lino 20.1.0 and xl 20.1.3

Don't use get_head_lines for notify (Lino 26c8a9c11)

Fixed :ticket:`3470` (Lino sets wrong booking direction in suggested bank
statement item) and  :ticket:`3471` (Deleting a voucher item does not refresh
the grid).

ItemsByVoucher now uses default display_mode for financial vouchers.

Fixed :ticket:`3473` (eevat declaration doesn't generate movements).
Added an exception "SumDeclarationField may not be payable" to avoid the pitfall.

2020-01-17
==========

Released lino-book 20.1.1 to make it installable via pip.

Changed the designation "Uploads" to "Upload files".

2020-01-15
==========

New plugin :mod:`lino.modlib.publisher`.

Changes in :mod:`lino.modlib.notify`.

2020-01-10
==========

Changes in :mod:`lino_xl.lib.ledger` and :mod:`lino_xl.lib.vat`. Fix booking
direction of returnable VAT.

Done :ticket:`3459` (Move calendar view from "cal" to a separate plugin
:mod:`lino_xl.lib.calview`). One consequence for data migration: DailyPlannerRow
has moved from cal to calview


2020-01-09
==========

The ShowInsert action now has a more specific help text.

:class:`lino_xl.lib.ledger.JournalsOverview` has now display_mode "summary".

Released :ref:`xl` 20.1.2.

More bugfixes in :mod:`lino_xl.lib.eevat` and :mod:`lino_xl.lib.vat`.


2020-01-03
==========

Released :ref:`care` 20.1.0 and :ref:`book` 20.1.0 just to get the :ref:`travis` builds green.
Released :ref:`xl` 20.1.1 for :ref:`cosi`.

More bugfixes in :mod:`lino_xl.lib.eevat` : Sales invoices to
:attr:`lino_xl.lib.eevat.VatRegimes.outside` weren't handled correctly.

2020-01-02
==========

New field :attr:`lino_xl.lib.ledger.Journal.preliminary`, and
:mod:`lino_xl.lib.vat` now ignores :term:`preliminary transactions`.

2020-01-01
==========

Released to PyPI : lino-react 20.1.0, lino-amici 20.1.0, XL 20.1.0
